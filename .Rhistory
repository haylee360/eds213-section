library(tidyverse)
library(DBI)
library(dbplyr)
conn <- DBI::dbConnect(duckdb::duckdb(), dbdir="tbdatabase.db")
DBI::dbListTables(conn)
tb_gdp_df <- tbl(conn, "tb_gdp")
tb_gdp_df
tb_gdp <- tbl(conn, "tb_gdp")
rm(tb_gdp_df)
tb_gdp_df <- tuberculosis %>%
inner_join(country, by = "CountryCode") %>%
inner_join(socioecon, by = c("CountryCode", "Year")) %>%
filter(!is.na(Incidence), !is.na(GDPCapita)) %>%
select(CountryCode, CountryName, Year, Incidence, GDPCapita)
# Reference the tables
tuberculosis <- tbl(conn, "tuberculosis")
country <- tbl(conn, "country")
socioecon <- tbl(conn, "socioecon")
tb_gdp_df <- tuberculosis %>%
inner_join(country, by = "CountryCode") %>%
inner_join(socioecon, by = c("CountryCode", "Year")) %>%
filter(!is.na(Incidence), !is.na(GDPCapita)) %>%
select(CountryCode, CountryName, Year, Incidence, GDPCapita)
tb_gdp_df <- tuberculosis %>%
inner_join(country, by = "CountryCode") %>%
inner_join(socioecon, by = c("CountryCode", "Year")) %>%
filter(!is.na(Incidence), !is.na(GDPCapita)) %>%
select(CountryCode, CountryName, Year, Incidence, GDPCapita) %>%
show_query()
tb_gdp_df <- tuberculosis %>%
inner_join(country, by = "CountryCode") %>%
inner_join(socioecon, by = c("CountryCode", "Year")) %>%
filter(!is.na(Incidence), !is.na(GDPCapita)) %>%
select(CountryCode, CountryName, Year, Incidence, GDPCapita) %>%
collect()
View(tb_gdp_df)
